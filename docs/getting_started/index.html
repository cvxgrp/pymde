<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="MDE" href="../mde/index.html" /><link rel="prev" title="Installation" href="../installation/index.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 7.0.1 and Furo 2023.05.20 -->
        <title>Getting started - pymde 0.1.18 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=e6660623a769aa55fea372102b9bf3151b292993" />
    <link rel="stylesheet" type="text/css" href="../_static/autoclasstoc.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">pymde 0.1.18 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">pymde 0.1.18 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">CONTENTS</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mde/index.html">MDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preprocess/index.html">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datasets/index.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing/index.html">Citing</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="getting-started">
<span id="id1"></span><h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this heading">#</a></h1>
<p>This page shows how to get started with PyMDE for four common tasks:</p>
<ul class="simple">
<li><p>visualizing datasets in two or three dimensions;</p></li>
<li><p>generating feature vectors for supervised learning;</p></li>
<li><p>computing classical embeddings, like PCA and spectral embedding;</p></li>
<li><p>drawing graphs in 2 or 3 dimensions;</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To learn how to create custom embeddings (with custom objective functions
and constraints), sanity check embeddings, identify possible outliers in
the original data, embed new data, and more, see the <a class="reference internal" href="../mde/index.html#mde"><span class="std std-ref">MDE guide</span></a>.
(We recommend reading the getting started guide first.)</p>
</div>
<section id="what-is-an-embedding">
<span id="embedding-definition"></span><h2>What is an embedding?<a class="headerlink" href="#what-is-an-embedding" title="Permalink to this heading">#</a></h2>
<p>An <em>embedding</em> of a finite set of items (such as biological cells, images,
words, nodes in a graph, or any other abstract object) is an assignment of each
item to a vector of fixed length; the original items
are <em>embedded</em> or mapped into a real vector space. The length of the vectors is
called the <em>embedding dimension</em>. An embedding is represented concretely by a
matrix, in which each row is the embedding vector of an item.</p>
<p>Embeddings provide concrete numerical representations of abstract items, for
use in downstream computational tasks. For example, when the embedding
dimension is 2 or 3, embeddings can be used to create a sort of chart or atlas
of the items. In such a chart, each point corresponds to an item, and its coordinates in space
are given by the embedding vector. These visualizations can help scientists and
analysts identify patterns or anomalies in the original data, and more
generally make it easier to explore large collections of data. PyMDE can embed
into 2 or 3 dimensions, but it can also be used to embed into many more
dimensions, which is useful when generating features for machine
learning tasks.</p>
<p>For an embedding to be useful, it
must be faithful to the original data (the items) in some
way. To make it easy to get started, PyMDE provides two high-level functions
for creating embeddings, based on related but different notions of
faithfulness. These functions handle the common case in which each item is
associated with either an original high-dimensional vector or a node in a
graph. The functions are</p>
<ul class="simple">
<li><p><a class="reference internal" href="../api/index.html#pymde.preserve_neighbors" title="pymde.preserve_neighbors"><code class="xref any py py-func docutils literal notranslate"><span class="pre">pymde.preserve_neighbors</span></code></a>,</p></li>
<li><p><a class="reference internal" href="../api/index.html#pymde.preserve_distances" title="pymde.preserve_distances"><code class="xref any py py-func docutils literal notranslate"><span class="pre">pymde.preserve_distances</span></code></a>.</p></li>
</ul>
<p>The first creates embeddings that focus on the local structure of the data,
putting similar items near each other and dissimilar items not near each other.
The second focuses more on the global structure, choosing embedding
vectors to respect some notion of original distance or dissimilarity between
items.</p>
<p>We’ll see how to use these functions below.</p>
</section>
<section id="visualizing-data">
<h2>Visualizing data<a class="headerlink" href="#visualizing-data" title="Permalink to this heading">#</a></h2>
<p>When the embedding dimension is 2 (or 3), embeddings can be used to visualize
large collections of items. These visualizations can sometimes lead to
new insights into the data.</p>
<section id="preserving-neighbors">
<h3>Preserving neighbors<a class="headerlink" href="#preserving-neighbors" title="Permalink to this heading">#</a></h3>
<p>Let’s create an embedding that preserves the local structure
of some data, using the <a class="reference internal" href="../api/index.html#pymde.preserve_neighbors" title="pymde.preserve_neighbors"><code class="xref any py py-func docutils literal notranslate"><span class="pre">pymde.preserve_neighbors</span></code></a> function. This function
is based on on preserving the <code class="docutils literal notranslate"><span class="pre">k</span></code>-nearest neighbors of each original vector
(where <code class="docutils literal notranslate"><span class="pre">k</span></code> is a parameter that by default is chosen on your behalf).</p>
<p>We’ll use the MNIST dataset, which contains images of handwritten digits, as an
example. The original items are the images, and each item (image) is
represented by an original vector containing the pixel values.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymde</span>

<span class="n">mnist</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">()</span>
</pre></div>
</div>
<p>Next, we embed.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">mde</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">preserve_neighbors</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">embedding</span> <span class="o">=</span> <span class="n">mde</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The first argument to <code class="docutils literal notranslate"><span class="pre">preserve_neighbors</span></code> is the data matrix: there are
70,000 images, each represented by a vector of length 784 , so <code class="docutils literal notranslate"><span class="pre">mnist.data</span></code>
is a <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code> of shape <code class="docutils literal notranslate"><span class="pre">(70,000,</span> <span class="pre">784)</span></code>. The optional keyword argument
<code class="docutils literal notranslate"><span class="pre">verbose=True</span></code> flag turns on helpful messages about what the function is
doing. The embedding dimension is 2 by default.</p>
<p>The function returns a <a class="reference internal" href="../api/index.html#pymde.MDE" title="pymde.MDE"><code class="xref any py py-class docutils literal notranslate"><span class="pre">pymde.MDE</span></code></a> object, which can be thought of as
describing the kind of embedding we would like. To compute the embedding, we
call the <a class="reference internal" href="../api/index.html#pymde.MDE.embed" title="pymde.MDE.embed"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">embed</span></code></a> method of the <code class="docutils literal notranslate"><span class="pre">mde</span></code> object. This returns a
<code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code> of shape <code class="docutils literal notranslate"><span class="pre">(70,000,</span> <span class="pre">2)</span></code>, in which <code class="docutils literal notranslate"><span class="pre">embedding[k]</span></code> is
the embedding vector assigned to the image <code class="docutils literal notranslate"><span class="pre">mnist.data[k]</span></code>.</p>
<p>We can visualize the embedding with a scatter plot. In the scatter plot,
we’ll color each point by the digit represented by the underlying image.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">pymde</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">embedding</span><span class="p">,</span> <span class="n">color_by</span><span class="o">=</span><span class="n">mnist</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;digits&#39;</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/mnist.png" src="../_images/mnist.png" />
<p>We can see that similar images are near each other in the embedding, while
dissimilar images are not.</p>
<p>It is also possible to embed into three or more dimensions. Here is an
example with three dimensions.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">mde</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">preserve_neighbors</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">embedding</span> <span class="o">=</span> <span class="n">mde</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pymde</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">embedding</span><span class="p">,</span> <span class="n">color_by</span><span class="o">=</span><span class="n">mnist</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;digits&#39;</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/mnist_3d.png" src="../_images/mnist_3d.png" />
<section id="customizing-embeddings">
<h4>Customizing embeddings<a class="headerlink" href="#customizing-embeddings" title="Permalink to this heading">#</a></h4>
<p>The <a class="reference internal" href="../api/index.html#pymde.preserve_neighbors" title="pymde.preserve_neighbors"><code class="xref any py py-func docutils literal notranslate"><span class="pre">pymde.preserve_neighbors</span></code></a> function takes a few keyword arguments
that can be used to customize the embedding. For example, you
can impose a <a class="reference internal" href="../api/index.html#pymde.Standardized" title="pymde.Standardized"><code class="xref any py py-func docutils literal notranslate"><span class="pre">pymde.Standardized</span></code></a> constraint: this
causes the embedding to have uncorrelated columns, and prevents it from
spreading out too much.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">embedding</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">preserve_neighbors</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="n">pymde</span><span class="o">.</span><span class="n">Standardized</span><span class="p">())</span><span class="o">.</span><span class="n">embed</span><span class="p">()</span>
<span class="n">pymde</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">embedding</span><span class="p">,</span> <span class="n">color_by</span><span class="o">=</span><span class="n">mnist</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;digits&#39;</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/mnist_std.png" src="../_images/mnist_std.png" />
<p>To learn about the other keyword arguments, read the tutorial on <a class="reference internal" href="../mde/index.html#mde"><span class="std std-ref">MDE</span></a>,
then consult the <a class="reference internal" href="../api/index.html#api-preserve-neighbors"><span class="std std-ref">API documentation</span></a>.</p>
<p>For more in-depth examples of creating neighborhood-based visualizations,
including 3D embeddings, see the <a class="reference internal" href="../examples/index.html#example-mnist"><span class="std std-ref">MNIST</span></a> and
<a class="reference internal" href="../examples/index.html#example-scrna"><span class="std std-ref">single-cell genomics</span></a> example notebooks.</p>
</section>
<section id="accessing-the-underlying-graph">
<h4>Accessing the underlying graph<a class="headerlink" href="#accessing-the-underlying-graph" title="Permalink to this heading">#</a></h4>
<p>You can access the graph underlying the MDE problem returned by
<code class="docutils literal notranslate"><span class="pre">pymde.preserve_neighbors</span></code>, using the following code.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">edges</span> <span class="o">=</span> <span class="n">mde</span><span class="o">.</span><span class="n">edges</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">mde</span><span class="o">.</span><span class="n">distortion_function</span><span class="o">.</span><span class="n">weights</span>
</pre></div>
</div>
<p>The value <code class="docutils literal notranslate"><span class="pre">weights[i]</span></code> is the weight for the edge <code class="docutils literal notranslate"><span class="pre">edges[i]</span></code>.</p>
</section>
</section>
<section id="preserving-distances">
<h3>Preserving distances<a class="headerlink" href="#preserving-distances" title="Permalink to this heading">#</a></h3>
<p>Next, we’ll create an embedding that roughly preserves the global structure
of some original data, by preserving some known original
distances between some pairs of items. We will embed the nodes of an unweighted
graph. For the original distance between two nodes, we’ll use the length of the
shortest path connecting them.</p>
<p>The specific graph we’ll use is an academic coauthorship graph, from
Google Scholar: the nodes are authors (with h-index at least 50), and two
authors have an edge between them if either has listed the author as a coauthor.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymde</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span>
<span class="n">google_scholar</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">google_scholar</span><span class="p">()</span>
<span class="n">mde</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">preserve_distances</span><span class="p">(</span><span class="n">google_scholar</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">embedding</span> <span class="o">=</span> <span class="n">mde</span><span class="o">.</span><span class="n">embed</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">data</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">google_scholar</span></code> dataset is a
<a class="reference internal" href="../api/index.html#pymde.Graph" title="pymde.Graph"><code class="xref any py py-class docutils literal notranslate"><span class="pre">pymde.Graph</span></code></a> object, which encodes the coauthorship network.
The <a class="reference internal" href="../api/index.html#pymde.preserve_distances" title="pymde.preserve_distances"><code class="xref any py py-func docutils literal notranslate"><span class="pre">pymde.preserve_distances</span></code></a> function returns a <a class="reference internal" href="../api/index.html#pymde.MDE" title="pymde.MDE"><code class="xref any py py-class docutils literal notranslate"><span class="pre">pymde.MDE</span></code></a>
object, and calling the <code class="docutils literal notranslate"><span class="pre">embed</span></code> method computes the embedding.</p>
<p>Notice that we passed in a <code class="docutils literal notranslate"><span class="pre">device</span></code> to <code class="docutils literal notranslate"><span class="pre">pymde.preserve_distances</span></code>;
this embedding approximately preserves over 80 million distances, so using a
GPU can speed things up.</p>
<p>Next we plot the embedding, coloring each point by how many coauthors the
author has in the network (normalized to be a percentile).</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">pymde</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">embedding</span><span class="p">,</span> <span class="n">color_by</span><span class="o">=</span><span class="n">google_scholar</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">&#39;coauthors&#39;</span><span class="p">])</span>
</pre></div>
</div>
<img alt="../_images/scholar.jpg" src="../_images/scholar.jpg" />
<p>The most collaborative authors are near the embedding, and less collaborative
ones are on the fringe. It also turns out that the diameter of the embedding
is close to the true diameter of the graph.</p>
<p>For a more in-depth study of this example, see the
<a class="reference internal" href="../examples/index.html#example-google-scholar"><span class="std std-ref">notebook on Google Scholar</span></a>.</p>
<section id="id2">
<h4>Customizing embeddings<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h4>
<p>The <a class="reference internal" href="../api/index.html#pymde.preserve_distances" title="pymde.preserve_distances"><code class="xref any py py-func docutils literal notranslate"><span class="pre">pymde.preserve_distances</span></code></a> function takes a few keyword arguments
that can be used to customize the embedding.</p>
<p>To learn about the keyword arguments, read the tutorial on <a class="reference internal" href="../mde/index.html#mde"><span class="std std-ref">MDE</span></a>,
then consult the <a class="reference internal" href="../api/index.html#api-preserve-distances"><span class="std std-ref">API documentation</span></a>.</p>
</section>
<section id="id3">
<h4>Accessing the underlying graph<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h4>
<p>You can access the graph underlying the MDE problem returned by
<code class="docutils literal notranslate"><span class="pre">pymde.preserve_distances</span></code>, using the following code.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">edges</span> <span class="o">=</span> <span class="n">mde</span><span class="o">.</span><span class="n">edges</span>
<span class="n">distances</span> <span class="o">=</span> <span class="n">mde</span><span class="o">.</span><span class="n">distortion_function</span><span class="o">.</span><span class="n">deviations</span>
</pre></div>
</div>
<p>The value <code class="docutils literal notranslate"><span class="pre">distances[i]</span></code> is the weight (which should be interpreted as a
distance) for the edge <code class="docutils literal notranslate"><span class="pre">edges[i]</span></code>.</p>
</section>
</section>
<section id="plotting">
<h3>Plotting<a class="headerlink" href="#plotting" title="Permalink to this heading">#</a></h3>
<section id="scatter-plots">
<h4>Scatter plots<a class="headerlink" href="#scatter-plots" title="Permalink to this heading">#</a></h4>
<p>The <a class="reference internal" href="../api/index.html#pymde.plot" title="pymde.plot"><code class="xref any py py-func docutils literal notranslate"><span class="pre">pymde.plot</span></code></a> function can be used to plot embeddings with dimension
at most 3. It takes an embedding as the argument, as well a number of optional
keyword arguments. For example, to plot an embedding and color each point
by some attribute, use:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">pymde</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">embedding</span><span class="p">,</span> <span class="n">color_by</span><span class="o">=</span><span class="n">attribute</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">attribute</span></code> variable is a NumPy array of length <code class="docutils literal notranslate"><span class="pre">embedding.shape[0]</span></code>,
in which <code class="docutils literal notranslate"><span class="pre">attribute[k]</span></code> is a tag or numerical value associated with item <code class="docutils literal notranslate"><span class="pre">k</span></code>.
For example, in the MNIST data, each entry in <code class="docutils literal notranslate"><span class="pre">attribute</span></code> is an <code class="docutils literal notranslate"><span class="pre">int</span></code>
between <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">9</span></code> representing the digit depicted in the image;
for single-cell data, each entry might be a string describing the type of
cell. Typically the attribute is not used to create the embedding, so coloring
by it is a sanity-check that the embedding has preserved prior knowledge about
the original data.</p>
<p>This function can be configured with a number of keyword arguments, which can
be seen in the <a class="reference internal" href="../api/index.html#pymde.plot" title="pymde.plot"><code class="xref any py py-func docutils literal notranslate"><span class="pre">API</span> <span class="pre">documentation</span></code></a>.</p>
</section>
<section id="movies">
<h4>Movies<a class="headerlink" href="#movies" title="Permalink to this heading">#</a></h4>
<p>The <a class="reference internal" href="../api/index.html#pymde.MDE.play" title="pymde.MDE.play"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">pymde.MDE.play</span></code></a> method can be used to create an animated GIF of the
embedding process. To create a GIF, first call <a class="reference internal" href="../api/index.html#pymde.MDE.embed" title="pymde.MDE.embed"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">pymde.MDE.embed</span></code></a> with
the <code class="docutils literal notranslate"><span class="pre">snapshot_every</span></code> keyword argument, then call <code class="docutils literal notranslate"><span class="pre">play</span></code>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">mde</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">snapshot_every</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mde</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">savepath</span><span class="o">=</span><span class="s1">&#39;/path/to/file.gif&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">snapshot_every=1</span></code> keyword argument instructs the <code class="docutils literal notranslate"><span class="pre">MDE</span></code> object to
take a snapshot of the embedding during every iteration of the solution
algorithm. The <code class="docutils literal notranslate"><span class="pre">play</span></code> method generates the GIF, and saves it to <code class="docutils literal notranslate"><span class="pre">savepath</span></code>.</p>
<p>This method can be configured with a number of keyword arguments,
which can be seen in the <a class="reference internal" href="../api/index.html#pymde.MDE.play" title="pymde.MDE.play"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">API</span> <span class="pre">documentation</span></code></a>.</p>
</section>
</section>
</section>
<section id="generating-feature-vectors">
<h2>Generating feature vectors<a class="headerlink" href="#generating-feature-vectors" title="Permalink to this heading">#</a></h2>
<p>The embeddings made via <a class="reference internal" href="../api/index.html#pymde.preserve_neighbors" title="pymde.preserve_neighbors"><code class="xref any py py-func docutils literal notranslate"><span class="pre">pymde.preserve_neighbors</span></code></a> and
<a class="reference internal" href="../api/index.html#pymde.preserve_distances" title="pymde.preserve_distances"><code class="xref any py py-func docutils literal notranslate"><span class="pre">pymde.preserve_distances</span></code></a> can be used as feature vectors for supervised
learning tasks. You can choose the dimension of the vectors by specifying the
<code class="docutils literal notranslate"><span class="pre">embedding_dim</span></code> keyword argument, e.g.,</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">embedding</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">preserve_neighbors</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">embed</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="classical-embeddings">
<h2>Classical embeddings<a class="headerlink" href="#classical-embeddings" title="Permalink to this heading">#</a></h2>
<p>PyMDE provides a few implementations of classical embeddings, for convenience.
To produce a PCA embedding of a data matrix, use the <a class="reference internal" href="../api/index.html#pymde.pca" title="pymde.pca"><code class="xref any py py-func docutils literal notranslate"><span class="pre">pymde.pca</span></code></a>
method, which returns an embedding:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">embedding</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">pca</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">)</span>
</pre></div>
</div>
<p>To create a Laplacian embedding based on the nearest neighbors of each row in a
data matrix or each node in a graph, use the <a class="reference internal" href="../api/index.html#pymde.laplacian_embedding" title="pymde.laplacian_embedding"><code class="xref any py py-func docutils literal notranslate"><span class="pre">pymde.laplacian_embedding</span></code></a>
method, which returns an MDE problem:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">mde</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">laplacian_embedding</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">embedding</span> <span class="o">=</span> <span class="n">mde</span><span class="o">.</span><span class="n">embed</span><span class="p">()</span>
</pre></div>
</div>
<p>To create a spectral embedding based on a sequence of edges (a <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>
of shape <code class="docutils literal notranslate"><span class="pre">(n_edges,</span> <span class="pre">2)</span></code>) and weights, use <a class="reference internal" href="../api/index.html#pymde.quadratic.spectral" title="pymde.quadratic.spectral"><code class="xref any py py-func docutils literal notranslate"><span class="pre">pymde.quadratic.spectral</span></code></a>.
(These embeddings are called “quadratic embeddings” in the MDE monograph.)</p>
</section>
<section id="drawing-graphs">
<h2>Drawing graphs<a class="headerlink" href="#drawing-graphs" title="Permalink to this heading">#</a></h2>
<p>PyMDE can be used to draw graphs in 2 or 3 dimensions.
Here is a very simple example that draws a cycle graph on 3 nodes.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">edges</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">triangle</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">Graph</span><span class="o">.</span><span class="n">from_edges</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
<span class="n">triangle</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/triangle.png" src="../_images/triangle.png" />
<p>Here is a more interesting example, which embeds a ternary tree. The
tree is created using the <a class="reference external" href="https://networkx.org/">NetworkX</a> package.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">networkx</span>

<span class="n">ternary_tree</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">balanced_tree</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">graph</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">networkx</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">(</span><span class="n">ternary_tree</span><span class="p">))</span>
<span class="n">embedding</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/tree.png" src="../_images/tree.png" />
<p>On a standard CPU, it takes PyMDE just 2 seconds to compute this layout;
for comparison, it takes NetworkX 30 seconds to compute a similar layout.</p>
<p>You can embed into 3 dimensions by passing <code class="docutils literal notranslate"><span class="pre">embedding_dim=3</span></code> to the <code class="docutils literal notranslate"><span class="pre">draw</span></code>
method.</p>
<p>For more in-depth examples, see the <a class="reference internal" href="../examples/index.html#example-graphs"><span class="std std-ref">notebook on drawing graphs</span></a>,
and the API documentation of <a class="reference internal" href="../api/index.html#pymde.Graph" title="pymde.Graph"><code class="xref any py py-class docutils literal notranslate"><span class="pre">pymde.Graph</span></code></a>.</p>
</section>
<section id="using-a-gpu">
<h2>Using a GPU<a class="headerlink" href="#using-a-gpu" title="Permalink to this heading">#</a></h2>
<p>If you have a CUDA-enabled GPU, you can use it to speed up the optimization
routine which computes the embedding.</p>
<p>The functions <code class="docutils literal notranslate"><span class="pre">pymde.preserve_neighbors</span></code> and
<code class="docutils literal notranslate"><span class="pre">pymde.preserve_distances</span></code>, as well as the method <code class="docutils literal notranslate"><span class="pre">Graph.draw</span></code>, all take a
keyword argument, called <code class="docutils literal notranslate"><span class="pre">device</span></code>, which controls whether or not a GPU is
used. Pass <code class="docutils literal notranslate"><span class="pre">device='cuda'</span></code> to use your GPU. (PyMDE computes embeddings on CPU
by default.)</p>
<p>For example, the below code shows how to create a neighbor-preserving
embedding of MNIST using a GPU.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymde</span>

<span class="n">mnist</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">()</span>
<span class="n">mde</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">preserve_neighbors</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">embedding</span> <span class="o">=</span> <span class="n">mde</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>On an NVIDIA GeForce GTX 1070, the <code class="docutils literal notranslate"><span class="pre">embed</span></code> method took just 5 seconds.</p>
</section>
<section id="reproducibility">
<h2>Reproducibility<a class="headerlink" href="#reproducibility" title="Permalink to this heading">#</a></h2>
<p>PyMDE’s optimization algorithm does not rely on randomness. However,
some functions, such as <code class="docutils literal notranslate"><span class="pre">pymde.preserve_neighbors</span></code>, may use random sampling
when generating the edges for an MDE problem. This means that if you call
<code class="docutils literal notranslate"><span class="pre">pymde.preserve_neighbors</span></code> multiple times on the same data set, you might
obtain slightly different MDE problems and therefore slightly different
embeddings. To prevent this from happening, you can set random seed state via
the <code class="docutils literal notranslate"><span class="pre">pymde.seed</span></code> function.</p>
<p>For example, the following code block will always create the same embedding.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymde</span>

<span class="n">mnist</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">MNIST</span><span class="p">()</span>

<span class="n">pymde</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mde</span> <span class="o">=</span> <span class="n">pymde</span><span class="o">.</span><span class="n">preserve_neighbors</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">embedding</span> <span class="o">=</span> <span class="n">mde</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../mde/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">MDE</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../installation/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Installation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Getting started</a><ul>
<li><a class="reference internal" href="#what-is-an-embedding">What is an embedding?</a></li>
<li><a class="reference internal" href="#visualizing-data">Visualizing data</a><ul>
<li><a class="reference internal" href="#preserving-neighbors">Preserving neighbors</a><ul>
<li><a class="reference internal" href="#customizing-embeddings">Customizing embeddings</a></li>
<li><a class="reference internal" href="#accessing-the-underlying-graph">Accessing the underlying graph</a></li>
</ul>
</li>
<li><a class="reference internal" href="#preserving-distances">Preserving distances</a><ul>
<li><a class="reference internal" href="#id2">Customizing embeddings</a></li>
<li><a class="reference internal" href="#id3">Accessing the underlying graph</a></li>
</ul>
</li>
<li><a class="reference internal" href="#plotting">Plotting</a><ul>
<li><a class="reference internal" href="#scatter-plots">Scatter plots</a></li>
<li><a class="reference internal" href="#movies">Movies</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#generating-feature-vectors">Generating feature vectors</a></li>
<li><a class="reference internal" href="#classical-embeddings">Classical embeddings</a></li>
<li><a class="reference internal" href="#drawing-graphs">Drawing graphs</a></li>
<li><a class="reference internal" href="#using-a-gpu">Using a GPU</a></li>
<li><a class="reference internal" href="#reproducibility">Reproducibility</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    </body>
</html>